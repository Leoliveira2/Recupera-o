<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pliometria Pro - Treinamento para Corredores</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .app-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .app-header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .app-header .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .notification {
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            font-weight: 500;
            text-align: center;
            animation: slideIn 0.5s ease-out;
        }

        .notification.info {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            color: white;
        }

        .notification.warning {
            background: linear-gradient(45deg, #fdcb6e, #e17055);
            color: white;
        }

        .notification.success {
            background: linear-gradient(45deg, #00b894, #00a085);
            color: white;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .exercise-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .exercise-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .exercise-card.completed {
            border-color: #00b894;
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.1), rgba(255, 255, 255, 0.95));
        }

        .exercise-content {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 25px;
            align-items: start;
        }

        @media (max-width: 768px) {
            .exercise-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
        }

        .exercise-image {
            width: 200px;
            height: 200px;
            border-radius: 15px;
            object-fit: cover;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .exercise-details h3 {
            color: #2c3e50;
            font-size: 1.4em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .exercise-type {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
            margin-bottom: 15px;
        }

        .type-mobilidade { background: #e8f4fd; color: #2980b9; }
        .type-ativacao { background: #fff3e0; color: #f39c12; }
        .type-forca { background: #fce4ec; color: #e91e63; }
        .type-pliometria { background: #f3e5f5; color: #9c27b0; }

        .exercise-level {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 500;
            margin-left: 10px;
        }

        .level-básico { background: #d4edda; color: #155724; }
        .level-intermediário { background: #fff3cd; color: #856404; }
        .level-avançado { background: #f8d7da; color: #721c24; }
        .level-expert { background: #d1ecf1; color: #0c5460; }

        .exercise-description {
            color: #555;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .exercise-tracking {
            display: grid;
            grid-template-columns: auto auto 1fr;
            gap: 15px;
            align-items: center;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        @media (max-width: 600px) {
            .exercise-tracking {
                grid-template-columns: 1fr;
                text-align: center;
            }
        }

        .progress-selector {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .progress-selector label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .progress-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .progress-option {
            padding: 10px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            background: white;
            color: #555;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9em;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .progress-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .progress-option:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .progress-option:hover::before {
            left: 100%;
        }

        .progress-option.selected {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .progress-option.selected::after {
            content: '✓';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-weight: bold;
            animation: checkmark 0.3s ease-in-out;
        }

        @keyframes checkmark {
            0% { opacity: 0; transform: translateY(-50%) scale(0); }
            100% { opacity: 1; transform: translateY(-50%) scale(1); }
        }

        .complete-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(45deg, #00b894, #00a085);
            color: white;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            justify-self: end;
        }

        .complete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
        }

        .complete-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 12px 25px;
            border: 2px solid #667eea;
            border-radius: 25px;
            background: transparent;
            color: #667eea;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #667eea;
            color: white;
        }

        .control-btn.danger {
            border-color: #e74c3c;
            color: #e74c3c;
        }

        .control-btn.danger:hover {
            background: #e74c3c;
            color: white;
        }

        .hidden {
            display: none;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: white;
            transform: scale(1.2);
        }

        .completion-message {
            text-align: center;
            padding: 50px 30px;
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            border-radius: 20px;
            font-size: 1.3em;
            font-weight: 500;
        }

        .level-selector {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .level-selector h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }

        .level-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .level-option {
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .level-option:hover {
            border-color: #667eea;
            transform: translateY(-3px);
        }

        .level-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), white);
        }

        .level-option h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .level-option p {
            color: #666;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .app-header h1 {
                font-size: 2em;
            }
            
            .exercise-image {
                width: 150px;
                height: 150px;
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>🏃‍♂️ Pliometria Pro</h1>
            <p class="subtitle">Treinamento pliométrico inteligente para corredores</p>
            <div class="progress-indicator" id="progress-indicator"></div>
        </header>

        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-number" id="current-day">1</div>
                <div class="stat-label">Dia Atual</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="current-level">Básico</div>
                <div class="stat-label">Nível</div>
                <div style="width: 100%; height: 4px; background: #e0e0e0; border-radius: 2px; margin-top: 10px; overflow: hidden;">
                    <div id="level-progress-bar" style="height: 100%; background: linear-gradient(45deg, #667eea, #764ba2); width: 0%; transition: width 0.5s ease;"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completed-exercises">0</div>
                <div class="stat-label">Exercícios Hoje</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-days">0</div>
                <div class="stat-label">Total de Dias</div>
                <div style="margin-top: 10px;">
                    <span id="streak-indicator" style="font-size: 0.8em; color: #667eea; font-weight: 600;">🔥 0 dias seguidos</span>
                </div>
            </div>
        </div>

        <div id="level-selector" class="level-selector">
            <h2>Escolha seu Nível de Experiência</h2>
            <div class="level-options">
                <div class="level-option" data-level="básico">
                    <h3>🌱 Básico</h3>
                    <p>Iniciante em pliometria ou voltando após pausa</p>
                </div>
                <div class="level-option" data-level="intermediário">
                    <h3>💪 Intermediário</h3>
                    <p>Já pratica exercícios básicos há algumas semanas</p>
                </div>
                <div class="level-option" data-level="avançado">
                    <h3>🔥 Avançado</h3>
                    <p>Experiência sólida em pliometria e força</p>
                </div>
                <div class="level-option" data-level="expert">
                    <h3>⚡ Expert</h3>
                    <p>Atleta experiente buscando máxima performance</p>
                </div>
            </div>
        </div>

        <div id="notification-area"></div>
        <main id="daily-workout"></main>

        <div class="controls">
            <button class="control-btn" id="generate-workout">🎯 Gerar Novo Treino</button>
            <button class="control-btn" id="change-level">📊 Mudar Nível</button>
            <button class="control-btn danger" id="reset-progress">🔄 Reiniciar Progresso</button>
        </div>
    </div>

    <script>
        // Banco de dados de exercícios
        const exercises = [
            {
                "id": "saltos-no-lugar",
                "name": "Saltos no Lugar (Vertical Jumps)",
                "type": "pliometria",
                "description": "Saltos verticais simples no lugar, focando na aterrissagem suave. Pés paralelos, saltar o mais alto possível, aterrissar suavemente com joelhos flexionados.",
                "image": "agachamento_salto.png",
                "level": "básico"
            },
            {
                "id": "marcha-elevacao-joelhos",
                "name": "Marcha com Elevação de Joelhos",
                "type": "pliometria",
                "description": "Marcha estacionária elevando joelhos alternadamente. Elevar joelho até 90°, manter postura ereta, braços em movimento alternado.",
                "image": "agachamento_salto.png",
                "level": "básico"
            },
            {
                "id": "saltos-laterais-pequenos",
                "name": "Saltos Laterais Pequenos",
                "type": "pliometria",
                "description": "Pequenos saltos laterais de um pé para outro. Saltar lateralmente 30-40cm, aterrissar em uma perna, estabilizar.",
                "image": "salto_lateral.png",
                "level": "básico"
            },
            {
                "id": "saltos-com-agachamento",
                "name": "Saltos com Agachamento",
                "type": "pliometria",
                "description": "Saltos verticais partindo da posição de agachamento. Agachar até 90°, saltar explosivamente, aterrissar em agachamento.",
                "image": "agachamento_salto.png",
                "level": "intermediário"
            },
            {
                "id": "saltos-unipodais-frente",
                "name": "Saltos Unipodais para Frente",
                "type": "pliometria",
                "description": "Saltos para frente em uma perna só. Saltar para frente 60-80cm, aterrissar na mesma perna, estabilizar.",
                "image": "salto_lateral.png",
                "level": "intermediário"
            },
            {
                "id": "pulos-alternados",
                "name": "Pulos Alternados",
                "type": "pliometria",
                "description": "Saltos alternando pernas com deslocamento horizontal. Saltar de uma perna para outra, maximizar distância horizontal.",
                "image": "agachamento_salto.png",
                "level": "intermediário"
            },
            {
                "id": "saltos-em-profundidade",
                "name": "Saltos em Profundidade",
                "type": "pliometria",
                "description": "Saltar de uma altura (sofá) e imediatamente saltar verticalmente. Descer do sofá, aterrissar e imediatamente saltar o mais alto possível.",
                "image": "agachamento_salto.png",
                "level": "avançado"
            },
            {
                "id": "saltos-laterais-cinta",
                "name": "Saltos Laterais com Cinta Elástica",
                "type": "pliometria",
                "description": "Saltos laterais com resistência de cinta elástica. Cinta ao redor dos tornozelos, saltos laterais contra resistência.",
                "image": "salto_lateral.png",
                "level": "avançado"
            },
            {
                "id": "saltos-triplos",
                "name": "Saltos Triplos",
                "type": "pliometria",
                "description": "Três saltos consecutivos na mesma perna. Três saltos máximos consecutivos, medir distância total.",
                "image": "salto_lateral.png",
                "level": "avançado"
            },
            {
                "id": "saltos-reativos-multiplos",
                "name": "Saltos Reativos Múltiplos",
                "type": "pliometria",
                "description": "Série de saltos rápidos e reativos. 5-8 saltos verticais consecutivos, tempo de contato mínimo.",
                "image": "agachamento_salto.png",
                "level": "expert"
            },
            {
                "id": "saltos-mudanca-direcao",
                "name": "Saltos com Mudança de Direção",
                "type": "pliometria",
                "description": "Saltos com rotação e mudança de direção. Saltar e girar 90-180°, aterrissar estável.",
                "image": "salto_lateral.png",
                "level": "expert"
            },
            {
                "id": "saltos-pliometricos-cinta",
                "name": "Saltos Pliométricos com Cinta",
                "type": "pliometria",
                "description": "Exercícios pliométricos com máxima resistência da cinta. Cinta de alta resistência, saltos explosivos contra resistência.",
                "image": "abducao_cinta.png",
                "level": "expert"
            },
            {
                "id": "basic-hop",
                "name": "Basic Hop",
                "type": "pliometria",
                "description": "Fique com os pés afastados na largura do quadril e os braços ao lado do corpo. Flexione levemente os joelhos e empurre a parte da frente dos pés para estender as pernas e saltar direto para o ar. Continue a saltar, focando em manter os pés no chão pelo menor tempo possível.",
                "image": "agachamento_salto.png",
                "level": "básico"
            },
            {
                "id": "quadrant-hop",
                "name": "Quadrant Hop",
                "type": "pliometria",
                "description": "Use giz ou fita adesiva para fazer um padrão de cruz no chão. Começando com os dois pés no quadrante inferior direito, salte para os outros quadrantes em sequência circular.",
                "image": "salto_lateral.png",
                "level": "intermediário"
            },
            {
                "id": "tuck-jump",
                "name": "Tuck Jump",
                "type": "pliometria",
                "description": "Fique com os pés afastados na largura do quadril. Salte direto para o ar e levante os joelhos em direção ao peito. Aterrisse suavemente com os dois pés e os joelhos levemente flexionados.",
                "image": "agachamento_salto.png",
                "level": "avançado"
            },
            {
                "id": "jumping-lunge",
                "name": "Jumping Lunge",
                "type": "pliometria",
                "description": "Fique em posição de afundo. Salte direto para cima trocando as pernas no ar. Aterrisse em posição de afundo com a perna oposta na frente.",
                "image": "agachamento_salto.png",
                "level": "avançado"
            },
            {
                "id": "skater-jump",
                "name": "Skater Jump",
                "type": "pliometria",
                "description": "Salte lateralmente de uma perna para outra, imitando o movimento de um patinador. Mantenha o equilíbrio e controle a aterrissagem.",
                "image": "salto_lateral.png",
                "level": "avançado"
            },
            {
                "id": "burpees",
                "name": "Burpees",
                "type": "pliometria",
                "description": "Exercício completo que combina agachamento, prancha, flexão e salto vertical. Excelente para desenvolver força e potência explosiva.",
                "image": "agachamento_salto.png",
                "level": "expert"
            },
            {
                "id": "alongamento-borboleta",
                "name": "Alongamento Borboleta",
                "type": "mobilidade",
                "description": "Sente-se no chão com as solas dos pés unidas. Puxe os calcanhares em direção ao corpo e incline o tronco suavemente para frente, mantendo as costas retas.",
                "image": "alongamento_borboleta.png",
                "level": "básico"
            },
            {
                "id": "ponte-isometrica",
                "name": "Ponte Isométrica",
                "type": "ativacao",
                "description": "Deite-se de costas com joelhos dobrados e pés apoiados no chão. Contraia glúteos e abdômen para elevar o quadril, formando uma linha reta dos ombros aos joelhos.",
                "image": "ponte_isometrica.png",
                "level": "básico"
            },
            {
                "id": "prancha-frontal",
                "name": "Prancha Frontal",
                "type": "ativacao",
                "description": "Apoie-se nos antebraços e pontas dos pés. Mantenha o corpo reto e alinhado da cabeça aos calcanhares, com o abdômen contraído.",
                "image": "prancha_frontal.png",
                "level": "básico"
            },
            {
                "id": "aducao-cinta",
                "name": "Adução com Cinta Elástica",
                "type": "forca",
                "description": "Prenda a cinta elástica no sofá e no seu tornozelo. Fique de lado e puxe a perna para dentro, cruzando na frente da perna de apoio.",
                "image": "aducao_cinta.png",
                "level": "intermediário"
            },
            {
                "id": "abducao-cinta",
                "name": "Abdução com Cinta Elástica",
                "type": "forca",
                "description": "Com a cinta presa no sofá e no tornozelo, fique de frente para o ponto de fixação. Puxe a perna para fora, trabalhando a lateral do quadril e glúteos.",
                "image": "abducao_cinta.png",
                "level": "intermediário"
            }
        ];

        // Estado do aplicativo
        let state = {
            currentLevel: null,
            day: 1,
            completedToday: false,
            completedExercises: new Set(),
            totalDays: 0,
            currentWorkout: [],
            exerciseProgress: {}, // Armazena o progresso de cada exercício
            levelProgress: 0, // Progresso no nível atual (0-100)
            streak: 0 // Sequência de dias consecutivos
        };

        // Elementos da UI
        const levelSelector = document.getElementById('level-selector');
        const workoutContainer = document.getElementById('daily-workout');
        const notificationArea = document.getElementById('notification-area');
        const currentDayEl = document.getElementById('current-day');
        const currentLevelEl = document.getElementById('current-level');
        const completedExercisesEl = document.getElementById('completed-exercises');
        const totalDaysEl = document.getElementById('total-days');
        const generateWorkoutBtn = document.getElementById('generate-workout');
        const changeLevelBtn = document.getElementById('change-level');
        const resetBtn = document.getElementById('reset-progress');

        // Funções principais
        function saveData() {
            const dataToSave = {
                ...state,
                completedExercises: Array.from(state.completedExercises)
            };
            localStorage.setItem('pliometriaProState', JSON.stringify(dataToSave));
        }

        function loadData() {
            const saved = localStorage.getItem('pliometriaProState');
            if (saved) {
                const loadedState = JSON.parse(saved);
                state = {
                    ...loadedState,
                    completedExercises: new Set(loadedState.completedExercises || [])
                };
            }
        }

        function showNotification(message, type = 'info') {
            notificationArea.innerHTML = `<div class="notification ${type}">${message}</div>`;
            setTimeout(() => {
                notificationArea.innerHTML = '';
            }, 5000);
        }

        function updateStats() {
            currentDayEl.textContent = state.day;
            currentLevelEl.textContent = state.currentLevel ? state.currentLevel.charAt(0).toUpperCase() + state.currentLevel.slice(1) : 'Não selecionado';
            completedExercisesEl.textContent = state.completedExercises.size;
            totalDaysEl.textContent = state.totalDays;
            
            // Atualizar barra de progresso do nível
            const progressBar = document.getElementById('level-progress-bar');
            if (progressBar && state.currentLevel) {
                let progressPercentage = 0;
                const daysInLevel = state.totalDays;
                
                // Calcular progresso baseado nos dias no nível atual
                if (daysInLevel <= 7) {
                    progressPercentage = (daysInLevel / 7) * 33; // 33% nos primeiros 7 dias
                } else if (daysInLevel <= 14) {
                    progressPercentage = 33 + ((daysInLevel - 7) / 7) * 33; // 66% até 14 dias
                } else {
                    progressPercentage = 66 + ((daysInLevel - 14) / 7) * 34; // 100% até 21 dias
                }
                
                progressPercentage = Math.min(progressPercentage, 100);
                progressBar.style.width = `${progressPercentage}%`;
            }
            
            // Atualizar indicador de streak
            const streakIndicator = document.getElementById('streak-indicator');
            if (streakIndicator) {
                streakIndicator.textContent = `🔥 ${state.streak} dias seguidos`;
            }
        }

        function calculateLevelProgression() {
            const levels = ['básico', 'intermediário', 'avançado', 'expert'];
            const currentLevelIndex = levels.indexOf(state.currentLevel);
            
            // Calcular pontuação baseada no desempenho
            let score = 0;
            let totalExercises = 0;
            
            Object.values(state.exerciseProgress).forEach(progress => {
                totalExercises++;
                switch(progress) {
                    case 'fácil': score += 4; break;
                    case 'adequado': score += 3; break;
                    case 'difícil': score += 2; break;
                    case 'muito-difícil': score += 1; break;
                }
            });
            
            if (totalExercises === 0) return false;
            
            const averageScore = score / totalExercises;
            const daysInLevel = state.totalDays;
            
            // Critérios para progressão de nível
            const shouldProgress = (
                (averageScore >= 3.5 && daysInLevel >= 7) || // Exercícios fáceis/adequados por 1 semana
                (averageScore >= 3.0 && daysInLevel >= 14) || // Exercícios adequados por 2 semanas
                (daysInLevel >= 21) // Forçar progressão após 3 semanas
            ) && currentLevelIndex < levels.length - 1;
            
            if (shouldProgress) {
                const newLevel = levels[currentLevelIndex + 1];
                showNotification(`🎉 Parabéns! Você evoluiu para o nível ${newLevel.toUpperCase()}! Seus exercícios serão mais desafiadores agora.`, 'success');
                state.currentLevel = newLevel;
                state.exerciseProgress = {}; // Reset progress for new level
                state.totalDays = 0; // Reset days counter for new level
                return true;
            }
            
            return false;
        }

        function generateWorkout() {
            if (!state.currentLevel) {
                showNotification('Por favor, selecione seu nível primeiro!', 'warning');
                return;
            }

            // Filtrar exercícios por nível
            const availableExercises = exercises.filter(ex => ex.level === state.currentLevel);
            
            // Separar por tipo
            const pliometricExercises = availableExercises.filter(ex => ex.type === 'pliometria');
            const otherExercises = availableExercises.filter(ex => ex.type !== 'pliometria');
            
            // Selecionar 3 exercícios obrigatórios (2 pliométricos + 1 outro)
            const selectedPliometric = pliometricExercises.sort(() => 0.5 - Math.random()).slice(0, 2);
            const selectedOther = otherExercises.sort(() => 0.5 - Math.random()).slice(0, 1);
            
            // Selecionar 1 exercício opcional (pliométrico)
            const remainingPliometric = pliometricExercises.filter(ex => 
                !selectedPliometric.some(sel => sel.id === ex.id)
            );
            const optionalExercise = remainingPliometric.sort(() => 0.5 - Math.random()).slice(0, 1);
            
            state.currentWorkout = [
                ...selectedPliometric.map(ex => ({...ex, required: true})),
                ...selectedOther.map(ex => ({...ex, required: true})),
                ...optionalExercise.map(ex => ({...ex, required: false}))
            ];
            
            state.completedExercises.clear();
            state.completedToday = false;
            
            renderWorkout();
            showNotification('🎯 Novo treino gerado! Complete os 3 exercícios obrigatórios e o opcional se desejar.', 'success');
        }

        function renderWorkout() {
            if (state.currentWorkout.length === 0) {
                workoutContainer.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #666;">
                        <h3>Nenhum treino ativo</h3>
                        <p>Clique em "Gerar Novo Treino" para começar!</p>
                    </div>
                `;
                return;
            }

            workoutContainer.innerHTML = '';
            
            state.currentWorkout.forEach((exercise, index) => {
                const isCompleted = state.completedExercises.has(exercise.id);
                
                const card = document.createElement('div');
                card.className = `exercise-card ${isCompleted ? 'completed' : ''}`;
                card.id = `ex-card-${index}`;
                
                card.innerHTML = `
                    <div class="exercise-content">
                        <img src="${exercise.image}" alt="${exercise.name}" class="exercise-image" onerror="this.style.display='none'">
                        <div class="exercise-details">
                            <h3>${exercise.name} ${exercise.required ? '' : '(Opcional)'}</h3>
                            <span class="exercise-type type-${exercise.type}">${exercise.type.charAt(0).toUpperCase() + exercise.type.slice(1)}</span>
                            <span class="exercise-level level-${exercise.level}">${exercise.level.charAt(0).toUpperCase() + exercise.level.slice(1)}</span>
                            <p class="exercise-description">${exercise.description}</p>
                            <div class="exercise-tracking">
                                <div class="progress-selector">
                                    <label>Como foi o exercício?</label>
                                    <div class="progress-options" id="progress-${index}">
                                        <div class="progress-option" data-value="fácil">😊 Fácil</div>
                                        <div class="progress-option" data-value="adequado">👍 Adequado</div>
                                        <div class="progress-option" data-value="difícil">😰 Difícil</div>
                                        <div class="progress-option" data-value="muito-difícil">🔥 Muito Difícil</div>
                                    </div>
                                </div>
                                <button class="complete-btn" data-exercise-id="${exercise.id}" data-index="${index}" ${isCompleted ? 'disabled' : ''}>
                                    ${isCompleted ? '✅ Concluído' : 'Concluir'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                workoutContainer.appendChild(card);
            });
            
            addEventListeners();
        }

        function addEventListeners() {
            // Seleção de nível
            document.querySelectorAll('.level-option').forEach(option => {
                option.onclick = () => {
                    document.querySelectorAll('.level-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    state.currentLevel = option.dataset.level;
                    levelSelector.style.display = 'none';
                    updateStats();
                    generateWorkout();
                    saveData();
                };
            });

            // Opções de progresso
            document.querySelectorAll('.progress-option').forEach(option => {
                option.onclick = (e) => {
                    const container = e.target.closest('.progress-options');
                    container.querySelectorAll('.progress-option').forEach(opt => opt.classList.remove('selected'));
                    e.target.classList.add('selected');
                };
            });

            // Botões de completar exercício
            document.querySelectorAll('.complete-btn').forEach(btn => {
                btn.onclick = (e) => {
                    const exerciseId = e.target.dataset.exerciseId;
                    const index = e.target.dataset.index;
                    const progressContainer = document.getElementById(`progress-${index}`);
                    const selectedProgress = progressContainer.querySelector('.progress-option.selected');
                    
                    if (!selectedProgress) {
                        showNotification('Por favor, avalie como foi o exercício antes de marcar como concluído.', 'warning');
                        return;
                    }
                    
                    // Armazenar progresso do exercício
                    const progressValue = selectedProgress.dataset.value;
                    state.exerciseProgress[exerciseId] = progressValue;
                    
                    state.completedExercises.add(exerciseId);
                    
                    const card = document.getElementById(`ex-card-${index}`);
                    card.classList.add('completed');
                    e.target.disabled = true;
                    e.target.textContent = '✅ Concluído';
                    
                    // Feedback visual baseado na dificuldade
                    let feedbackMessage = '';
                    switch(progressValue) {
                        case 'fácil':
                            feedbackMessage = '💪 Ótimo! Você está dominando este exercício!';
                            break;
                        case 'adequado':
                            feedbackMessage = '👍 Perfeito! Nível ideal de desafio!';
                            break;
                        case 'difícil':
                            feedbackMessage = '🔥 Desafiador! Você está se superando!';
                            break;
                        case 'muito-difícil':
                            feedbackMessage = '💯 Incrível! Você está dando o seu máximo!';
                            break;
                    }
                    
                    // Verificar se todos os exercícios obrigatórios foram concluídos
                    const requiredExercises = state.currentWorkout.filter(ex => ex.required);
                    const completedRequired = requiredExercises.filter(ex => state.completedExercises.has(ex.id));
                    
                    if (completedRequired.length === requiredExercises.length && !state.completedToday) {
                        state.completedToday = true;
                        state.day++;
                        state.totalDays++;
                        
                        // Verificar progressão de nível
                        const leveledUp = calculateLevelProgression();
                        
                        if (!leveledUp) {
                            showNotification(`🎉 Parabéns! Você completou o treino de hoje! ${feedbackMessage}`, 'success');
                        }
                        
                        // Atualizar streak
                        state.streak++;
                        
                        // Mensagens especiais para streaks
                        if (state.streak === 7) {
                            showNotification('🔥 Uma semana completa! Você está no caminho certo!', 'success');
                        } else if (state.streak === 30) {
                            showNotification('🏆 30 dias consecutivos! Você é um verdadeiro atleta!', 'success');
                        }
                    } else {
                        showNotification(feedbackMessage, 'info');
                    }
                    
                    updateStats();
                    saveData();
                };
            });
        }

        // Event listeners para controles
        generateWorkoutBtn.onclick = generateWorkout;
        
        changeLevelBtn.onclick = () => {
            levelSelector.style.display = 'block';
            document.querySelectorAll('.level-option').forEach(opt => opt.classList.remove('selected'));
        };
        
        resetBtn.onclick = () => {
            if (confirm('Tem certeza que deseja apagar todo o seu progresso?')) {
                localStorage.removeItem('pliometriaProState');
                state = {
                    currentLevel: null,
                    day: 1,
                    completedToday: false,
                    completedExercises: new Set(),
                    totalDays: 0,
                    currentWorkout: []
                };
                levelSelector.style.display = 'block';
                workoutContainer.innerHTML = '';
                updateStats();
                showNotification('Progresso reiniciado! Selecione seu nível para começar.', 'info');
            }
        };

        // Inicialização
        loadData();
        updateStats();
        
        if (state.currentLevel) {
            levelSelector.style.display = 'none';
            if (state.currentWorkout.length > 0) {
                renderWorkout();
            } else {
                generateWorkout();
            }
        } else {
            levelSelector.style.display = 'block';
            // Adicionar event listeners para seleção de nível na inicialização
            addEventListeners();
        }
        
        // Mensagem de boas-vindas
        if (state.totalDays === 0) {
            showNotification('🎯 Bem-vindo ao Pliometria Pro! Selecione seu nível e comece seu treinamento personalizado.', 'info');
        }
    </script>
</body>
</html>
